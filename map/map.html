<!-- search bar -->
<div class="container mapsearch">
	<div class="input-group">
		<input id="searchWpInput" type="text" class="form-control" placeholder="search waypoint / coordinates or click on map" ng-model="globalData.navplan.selectedWaypoint.checkpoint"
			   uib-typeahead="geoname.name for geoname in searchGeonamesByValue($viewValue)" typeahead-min-length="2"
			   typeahead-on-select="onGeonameSelect($item)"
			   ng-blur="updateTrack()" />
		<span class="input-group-btn">
			<button type="button" class="btn btn-primary" ng-click="onGeonameSearch();"><i class="glyphicon glyphicon-search"></i></button>
		</span>
	</div>
</div>
<!-- zoom buttons -->
<div class="btn-group-vertical mapbutton-zoom">
	<button type="button" class="btn btn-primary btn-circle btn-lg" style="border-top-left-radius: 25px; border-top-right-radius: 25px" ng-click="onZoomInClicked();" title="zoom in"><span class="glyphicon glyphicon-plus"></span></button>
	<button type="button" class="btn btn-primary btn-circle btn-lg" style="border-bottom-left-radius: 25px; border-bottom-right-radius: 25px" ng-click="onZoomOutClicked();" title="zoom out"><span class="glyphicon glyphicon-minus"></span></button>
</div>
<!-- location button -->
<div class="mapbutton-location">
	<button type="button" class="btn btn-circle btn-lg" ng-class="{ 'btn-primary' : globalData.locationStatus == 'off', 'btn-success' : globalData.locationStatus == 'current', 'btn-warning' : globalData.locationStatus == 'waiting', 'btn-danger' : globalData.locationStatus == 'error' }" ng-class="{ 'active': globalData.showLocation }" ng-click="onLocationClicked();" title="own location"><span class="glyphicon glyphicon-record"></span></button>
</div>
<!-- traffic button -->
<div class="mapbutton-traffic">
	<button type="button" class="btn btn-primary btn-circle btn-lg" ng-class="{ 'btn-primary' : globalData.trafficStatus == 'off', 'btn-success' : globalData.trafficStatus == 'current', 'btn-warning' : globalData.trafficStatus == 'waiting', 'btn-danger' : globalData.trafficStatus == 'error' }" ng-class="{ 'active': globalData.showTraffic }" ng-click="onTrafficClicked();" title="traffic"><span class="glyphicon glyphicon-plane"></span></button>
</div>
<!-- kml export button -->
<div class="mapbutton-kmlexport" ng-show="globalData.navplan.waypoints.length > 0">
	<button type="button" class="btn btn-primary btn-circle btn-lg" ng-click="onKmlClicked();" title="export kml"><span class="glyphicon glyphicon-globe"></span></button>
</div>
<!-- offline cache button -->
<div class="mapbutton-offlinecache" ng-show="globalData.navplan.waypoints.length > 0 || globalData.cacheStatus != 'off'">
	<button type="button" class="btn btn-primary btn-circle btn-lg" ng-class="{ 'btn-primary' : globalData.cacheStatus == 'off', 'btn-success' : globalData.cacheStatus == 'updated', 'btn-warning' : globalData.cacheStatus == 'updating', 'btn-danger' : globalData.cacheStatus == 'error' }" ng-class="{ 'active': globalData.offlineCache }" ng-click="onOfflineCacheClicked();" title="offline cache"><span class="glyphicon glyphicon-cloud-download"></span></button>
</div>
<div class="progress map-cacheprogress" ng-show="globalData.cacheStatus == 'updating'">
	<div class="progress-bar progress-bar-warning progress-bar-striped active" role="progressbar" aria-valuenow="{{ globalData.cacheProgress.loaded }}" aria-valuemin="0" aria-valuemax="{{ globalData.cacheProgress.total }}" style="width: {{ globalData.cacheProgress.percent }}%;">
		{{ globalData.cacheProgress.percent }}%
	</div>
</div>
<!-- feature popup -->
<div id="feature-popup" class="ol-popup" style="visibility: hidden">
	<a href="#" id="feature-popup-closer" class="ol-popup-closer ol-popup-feature" ng-click="$event.preventDefault(); onCloseOverlayClicked();"></a>
	<div id="feature-popup-content">
		<h4>{{ globalData.selectedWp.checkpoint }}</h4>
		<p ng-show="globalData.selectedWp.isNew"><button type="button" class="btn btn-success btn-circle" ng-click="onAddSelectedWaypointClicked()"><i class="glyphicon glyphicon-plus"></i></button> Add to Track</p>
		<p ng-show="globalData.selectedWp.isNew && globalData.selectedWp.type == 'airport'"><button type="button" class="btn btn-warning btn-circle" ng-click="onSetAsAlternateClicked()"><i class="glyphicon glyphicon-plus"></i></button> Set as Alternate</p>
		<p ng-show="!globalData.selectedWp.isNew"><button type="button" class="btn btn-warning btn-circle" ng-click="onEditSelectedWaypointClicked()"><i class="glyphicon glyphicon-edit"></i></button> Edit Track Waypoint</p>
		<p ng-show="!globalData.selectedWp.isNew"><button type="button" class="btn btn-danger btn-circle" ng-click="onRemoveSelectedWaypointClicked()"><i class="glyphicon glyphicon-remove"></i></button> Remove from Track</p>
		<p ng-show="isLoggedIn() && (globalData.selectedWp.type == 'user' || globalData.selectedWp.type == 'geoname')"><button type="button" class="btn btn-primary btn-circle" ng-click="onEditUserWaypointClicked()"><i class="glyphicon glyphicon-edit"></i></button> Edit/Save User Waypoint</p>
		<hr ng-show="globalData.selectedWp.airport.weatherInfo || (globalData.selectedWp.airport.webcams && globalData.selectedWp.airport.webcams.length > 0)" />
		<p ng-show="globalData.selectedWp.airport.weatherInfo"><a href="#" ng-click="$event.preventDefault(); onShowWeatherInfo();" class="btn btn-success btn-circle"><i class="glyphicon glyphicon-file"></i></a> METAR / TAF</p>
		<p ng-repeat="webcam in globalData.selectedWp.airport.webcams"><a href="{{ webcam.url }}" target="_blank" class="btn btn-success btn-circle"><i class="glyphicon glyphicon-facetime-video"></i></a> {{ webcam.name }}</p>
		<hr ng-show="globalData.selectedWp.airport.charts && globalData.selectedWp.airport.charts.length > 0" />
		<p ng-repeat="chart in globalData.selectedWp.airport.charts"><button type="button" class="btn btn-info btn-circle" ng-click="onDisplayChartClicked(chart.id)"><i class="glyphicon glyphicon-file"></i></button> {{ chart.type }}</p>
	</div>
</div>
<!-- traffic popup -->
<div id="traffic-popup" class="ol-popup ol-popup-traffic" style="visibility: hidden">
	<a href="#" id="traffic-popup-closer" class="ol-popup-closer" ng-click="$event.preventDefault(); onCloseOverlayClicked();"></a>
	<div id="traffic-popup-content">
		<h4>{{ selectedTraffic.registration }}</h4>
		<table cellspacing="2">
			<tr>
				<td>Model:</td>
				<td>{{ selectedTraffic.aircraftModelType }}</td>
			</tr>
			<tr>
				<td>Manufacturer:</td>
				<td>{{ selectedTraffic.manufacturer }}</td>
			</tr>
			<tr>
				<td>Address:</td>
				<td>{{ selectedTraffic.address }} ({{ selectedTraffic.addresstype }})</td>
			</tr>
		</table>
		<hr />
		<p><a href="#" ng-click="$event.preventDefault(); onFollowSelectedTraffic();" class="btn btn-info btn-circle"><i class="glyphicon glyphicon-screenshot"></i></a> Follow Aircraft on Map</p>
	</div>
</div>
<!-- weather popup -->
<div id="weather-popup" class="ol-popup ol-popup-weather" style="visibility: hidden">
	<a href="#" id="weather-popup-closer" class="ol-popup-closer" ng-click="$event.preventDefault(); onCloseOverlayClicked()"></a>
	<div id="weather-popup-content">
		<h4>METAR / TAF {{ selectedWeather.airport_icao }}</h4>
		<p ng-show="selectedWeather.metar" >
			METAR {{ selectedWeather.metar.raw_text }}
			<br />
			<i>({{ getAgeString(selectedWeather.metar.observation_time); }} old)</i>
		</p>
		<p ng-show="selectedWeather.taf" >
			{{ selectedWeather.taf.raw_text }}
			<br />
			<i>({{ getAgeString(selectedWeather.taf.issue_time); }} old)</i>
		</p>
	</div>
</div>
<!-- map -->
<div id="map" class="map"></div>
